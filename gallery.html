<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Gallery | For Reine</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <!-- Mobile PWA meta tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="For Reine">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#ec4899">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png">
  <style>
    /* Navigation styles */
    .gallery-nav {
      display: flex;
      gap: 8px;
      padding: 12px 16px;
      position: relative;
      z-index: 2;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.35);
    }

    .gallery-nav__link {
      flex: 1;
      text-align: center;
      padding: 10px 12px;
      border-radius: 14px;
      text-decoration: none;
      font-weight: 900;
      color: rgba(17, 24, 39, 0.75);
      background: rgba(255, 255, 255, 0.55);
      border: 1px solid rgba(17, 24, 39, 0.1);
      transition: all 0.2s ease;
    }

    .gallery-nav__link:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(17, 24, 39, 0.1);
    }

    .gallery-nav__link.is-active {
      border: 0;
      color: white;
      background: linear-gradient(135deg, rgba(236, 72, 153, 0.95), rgba(139, 92, 246, 0.95));
    }

    /* Gallery specific styles */
    .gallery-screen {
      display: block;
      padding: 14px 16px 18px;
      overflow: auto;
      position: relative;
      z-index: 2;
      height: calc(100% - 60px);
    }
  </style>
</head>
<body>
  <main class="app" aria-label="Gallery">
    <div class="phone" role="application" aria-label="Gallery for Reine">
      <div class="bgParticles" id="bgParticles" aria-hidden="true"></div>

      <!-- In gallery.html, replace the navigation with this: -->
<nav class="gallery-nav" aria-label="Main navigation">
  <a href="gallery.html" class="gallery-nav__link is-active">Gallery</a>
  <a href="games.html" class="gallery-nav__link">Games</a>
  <a href="message.html" class="gallery-nav__link">Message</a>
</nav>

      <section class="gallery-screen" id="gallery-content" aria-labelledby="giftTitle">
        <!-- Library block removed here -->

        <div class="card card--hero">
          <h2 class="h2" id="giftTitle">So this is really Renoooo, this is for you babe</h2>
          <p class="sub">I love you for a thousand years. I'm so grateful for you albee. Scroll and explore a bit of my love.</p>
        </div>

        <section class="mix" aria-label="Memories">
          <div class="mix__head">
            <div class="panel__title">Photos & Videos</div>
            <p class="sub">Drop files into <code>assets/img/photos/</code> and <code>assets/video/</code>, then list them in <code>assets/js/app.js</code>.</p>
          </div>

          <div class="mix__feed" id="mixFeed" aria-label="Mixed feed">
            <!-- Content will be populated by JavaScript -->
          </div>
        </section>

        <div class="lightbox" id="lightbox" aria-hidden="true">
          <button class="lightbox__close" id="lightboxClose" type="button" aria-label="Close">Ã—</button>
          <button class="lightbox__nav" id="lightboxPrev" type="button" aria-label="Previous">â€¹</button>
          <figure class="lightbox__figure">
            <img class="lightbox__img" id="lightboxImg" alt="" />
            <figcaption class="lightbox__caption" id="lightboxCaption"></figcaption>
          </figure>
          <button class="lightbox__nav" id="lightboxNext" type="button" aria-label="Next">â€º</button>
        </div>
      </section>

      <footer class="bottombar" aria-label="Footer">
        <div class="bottombar__dot"></div>
      </footer>
    </div>
  </main>

  <script>
    (() => {
      // Copy the photos and videos arrays from app.js
      const photos = [];
      const videos = [];

      const mixFeed = document.getElementById('mixFeed');
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightboxImg');
      const lightboxCaption = document.getElementById('lightboxCaption');
      const lightboxClose = document.getElementById('lightboxClose');
      const lightboxPrev = document.getElementById('lightboxPrev');
      const lightboxNext = document.getElementById('lightboxNext');

      let activePhotoIndex = 0;

      function renderMixFeed() {
        if (!mixFeed) return;
        mixFeed.innerHTML = '';

        const hasAny = photos.length || videos.length;
        if (!hasAny) {
          const p = document.createElement('div');
          p.className = 'card';
          p.textContent = 'Add photos to assets/img/photos/ and videos to assets/video/, then list them in assets/js/app.js (photos/videos arrays).';
          mixFeed.appendChild(p);
          return;
        }

        const maxLen = Math.max(photos.length, videos.length);
        const feed = [];
        for (let i = 0; i < maxLen; i++) {
          if (photos[i]) feed.push({ kind: 'photo', index: i, ...photos[i] });
          if (videos[i]) feed.push({ kind: 'video', index: i, ...videos[i] });
        }

        const floatClasses = ['floatA', 'floatB', 'floatC'];

        feed.forEach((item, i) => {
          const row = document.createElement('article');
          row.className = `mixItem ${i % 2 === 0 ? 'is-left' : 'is-right'}`;

          const card = document.createElement('div');
          card.className = `mixCard ${floatClasses[i % floatClasses.length]}`;

          const media = document.createElement('div');
          media.className = 'mixCard__media';

          if (item.kind === 'photo') {
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.style.padding = '0';
            btn.style.border = '0';
            btn.style.background = 'transparent';
            btn.style.width = '100%';
            btn.addEventListener('click', () => openLightbox(item.index));

            const img = document.createElement('img');
            img.src = item.src;
            img.alt = item.caption || `Photo ${item.index + 1}`;
            img.loading = 'lazy';

            btn.appendChild(img);
            media.appendChild(btn);
          } else {
            const v = document.createElement('video');
            v.controls = true;
            v.preload = 'metadata';
            v.src = item.src;
            media.appendChild(v);
          }

          const body = document.createElement('div');
          body.className = 'mixCard__body';

          const title = document.createElement('p');
          title.className = 'mixCard__title';
          title.textContent = item.kind === 'video' ? (item.title || 'Video') : 'Photo';

          body.appendChild(title);

          const messageWrap = document.createElement('div');
          messageWrap.className = 'mixCard__message';

          const message = document.createElement('p');
          message.className = 'mixCard__messageText';
          message.textContent = item.message || item.caption || '';

          messageWrap.appendChild(message);
          body.appendChild(messageWrap);

          card.appendChild(media);
          card.appendChild(body);
          row.appendChild(card);
          mixFeed.appendChild(row);
        });
      }

      function openLightbox(idx) {
        activePhotoIndex = idx;
        updateLightbox();
        lightbox.classList.add('is-open');
        lightbox.setAttribute('aria-hidden', 'false');
      }

      function closeLightbox() {
        lightbox.classList.remove('is-open');
        lightbox.setAttribute('aria-hidden', 'true');
      }

      function updateLightbox() {
        const item = photos[activePhotoIndex];
        if (!item) return;
        lightboxImg.src = item.src;
        lightboxImg.alt = item.caption || `Photo ${activePhotoIndex + 1}`;
        lightboxCaption.textContent = item.caption || '';
      }

      function prevPhoto() {
        if (!photos.length) return;
        activePhotoIndex = (activePhotoIndex - 1 + photos.length) % photos.length;
        updateLightbox();
      }

      function nextPhoto() {
        if (!photos.length) return;
        activePhotoIndex = (activePhotoIndex + 1) % photos.length;
        updateLightbox();
      }

      // Event listeners for lightbox
      lightboxClose.addEventListener('click', closeLightbox);
      lightboxPrev.addEventListener('click', prevPhoto);
      lightboxNext.addEventListener('click', nextPhoto);

      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) closeLightbox();
      });

      document.addEventListener('keydown', (e) => {
        if (!lightbox.classList.contains('is-open')) return;
        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowLeft') prevPhoto();
        if (e.key === 'ArrowRight') nextPhoto();
      });

      // Start background particles
      function spawnBgParticle() {
        const bgParticles = document.getElementById('bgParticles');
        if (!bgParticles) return;
        if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

        const el = document.createElement('span');
        el.className = 'bgParticle';

        const pick = Math.random();
        el.textContent = pick < 0.72 ? 'â¤' : 'ðŸŒ¹';

        const x = Math.random() * 100;
        const size = 14 + Math.random() * 20;
        const dur = 5.5 + Math.random() * 5.5;
        const drift = (-16 + Math.random() * 32).toFixed(2) + 'px';
        const rot = (-18 + Math.random() * 36).toFixed(2) + 'deg';

        el.style.setProperty('--x', x.toFixed(2) + '%');
        el.style.setProperty('--size', size.toFixed(0) + 'px');
        el.style.setProperty('--dur', dur.toFixed(2) + 's');
        el.style.setProperty('--drift', drift);
        el.style.setProperty('--rot', rot);

        bgParticles.appendChild(el);

        window.setTimeout(() => {
          el.remove();
        }, Math.ceil(dur * 1000) + 200);
      }

      function startParticles() {
        const bgParticles = document.getElementById('bgParticles');
        if (!bgParticles) return;
        for (let i = 0; i < 8; i++) spawnBgParticle();
        window.setInterval(spawnBgParticle, 420);
      }

      // Initialize everything
      renderMixFeed();
      startParticles();
    })();
  </script>
</body>
</html>